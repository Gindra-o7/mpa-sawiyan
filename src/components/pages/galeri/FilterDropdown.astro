---
import { Globe, ChevronDown } from "lucide-astro";

interface FilterOption {
  name: string;
  value: string;
}

const filterOptions: FilterOption[] = [
  { name: "Semua", value: "semua" },
  { name: "Kegiatan", value: "kegiatan" },
  { name: "Acara", value: "acara" },
  { name: "Program Sosial", value: "program-sosial" },
  { name: "Program Kemanusiaan", value: "program-kemanusiaan" },
  { name: "Program Keagamaan", value: "program-keagamaan" },
];
---

<div class="relative">
  <button
    id="filter-dropdown-btn"
    class="flex items-center gap-2 px-4 py-2 text-[#388E3C] font-semibold hover:bg-[#388E3C]/5 rounded-lg transition-colors duration-200 group"
  >
    <Globe class="w-5 h-5" />
    <span id="filter-selected">Semua</span>
    <ChevronDown class="w-4 h-4 transition-transform duration-200 group-hover:rotate-180" />
  </button>

  <!-- Dropdown Menu -->
  <div
    id="filter-dropdown"
    class="absolute top-full left-0 mt-2 bg-white rounded-lg shadow-xl border border-gray-200 py-2 min-w-[200px] z-50 hidden"
  >
    {filterOptions.map((option) => (
      <button
        class="w-full text-left px-4 py-2 text-gray-700 hover:bg-[#388E3C]/10 hover:text-[#388E3C] transition-colors duration-200 filter-option"
        data-value={option.value}
        data-name={option.name}
      >
        {option.name}
      </button>
    ))}
  </div>
</div>

<script>
  const dropdownBtn = document.getElementById("filter-dropdown-btn");
  const dropdown = document.getElementById("filter-dropdown");
  const selectedText = document.getElementById("filter-selected");
  const filterOptions = document.querySelectorAll(".filter-option");

  if (dropdownBtn && dropdown && selectedText) {
    // Toggle dropdown
    dropdownBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      dropdown?.classList.toggle("hidden");
    });

    // Close dropdown when clicking outside
    document.addEventListener("click", (e) => {
      if (!dropdownBtn.contains(e.target as Node) && !dropdown.contains(e.target as Node)) {
        dropdown?.classList.add("hidden");
      }
    });

    // Handle option selection
    filterOptions.forEach((option) => {
      option.addEventListener("click", () => {
        const name = option.getAttribute("data-name");
        const value = option.getAttribute("data-value");
        
        if (name && selectedText) {
          selectedText.textContent = name;
        }

        // Update active state
        filterOptions.forEach((opt) => {
          opt.classList.remove("bg-[#388E3C]/10", "text-[#388E3C]");
          if (opt === option) {
            opt.classList.add("bg-[#388E3C]/10", "text-[#388E3C]");
          }
        });

        // Filter gallery items
        const galleryItems = document.querySelectorAll("[data-gallery-category]");
        galleryItems.forEach((item) => {
          const itemCategory = item.getAttribute("data-gallery-category");
          if (value === "semua" || itemCategory === name) {
            item.classList.remove("hidden");
          } else {
            item.classList.add("hidden");
          }
        });

        dropdown?.classList.add("hidden");
      });
    });
  }
</script>

