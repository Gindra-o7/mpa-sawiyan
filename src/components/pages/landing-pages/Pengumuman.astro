---
import { ArrowRight, ArrowUpRight } from "@lucide/astro";

const title = "Berita & Pengumuman Terbaru";
const linkHref = "/berita";

const pengumumanData = [
  {
    slug: "program-beasiswa-2025",
    judul: "Program Beasiswa Yayasan Sawiyan 2025",
    thumbnail: "https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800&h=600&fit=crop",
    url_thumbnail: "https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800&h=600&fit=crop",
    isi: "Yayasan Sawiyan membuka program beasiswa untuk siswa berprestasi dan keluarga kurang mampu. Program ini bertujuan untuk memberikan kesempatan pendidikan yang lebih baik bagi generasi penerus bangsa.",
    date_created: "2024-11-15T10:00:00",
  },
  {
    slug: "bantuan-kemanusiaan-2025",
    judul: "Kegiatan Bantuan Kemanusiaan di Daerah Terdampak Bencana",
    thumbnail: "https://images.unsplash.com/photo-1488521787991-ed7bbaae773c?w=800&h=600&fit=crop",
    url_thumbnail: "https://images.unsplash.com/photo-1488521787991-ed7bbaae773c?w=800&h=600&fit=crop",
    isi: "Yayasan Sawiyan menggelar program bantuan kemanusiaan untuk korban bencana alam. Bantuan meliputi bahan makanan, pakaian, dan kebutuhan pokok lainnya. Mari bersama-sama membantu mereka yang membutuhkan.",
    date_created: "2024-11-10T14:30:00",
  },
  {
    slug: "kegiatan-keagamaan-2025",
    judul: "Kegiatan Rutin Kajian Keagamaan Bulanan",
    thumbnail: "https://images.unsplash.com/photo-1511632765486-a01980e01a18?w=800&h=600&fit=crop",
    url_thumbnail: "https://images.unsplash.com/photo-1511632765486-a01980e01a18?w=800&h=600&fit=crop",
    isi: "Yayasan Sawiyan mengadakan kajian keagamaan rutin setiap bulan yang terbuka untuk umum. Kegiatan ini bertujuan untuk memperdalam pemahaman keagamaan dan memperkuat ukhuwah islamiyah.",
    date_created: "2024-11-08T09:15:00",
  },
  {
    slug: "kampanye-lingkungan-2025",
    judul: "Kampanye Peduli Lingkungan: Aksi Bersih-Bersih",
    thumbnail: "https://images.unsplash.com/photo-1469571486292-0ba58a3f068b?w=800&h=600&fit=crop",
    url_thumbnail: "https://images.unsplash.com/photo-1469571486292-0ba58a3f068b?w=800&h=600&fit=crop",
    isi: "Yayasan Sawiyan menggelar aksi bersih-bersih lingkungan sebagai bentuk kepedulian terhadap kelestarian alam. Ayo ikut serta dalam kegiatan positif ini untuk menciptakan lingkungan yang lebih baik.",
    date_created: "2024-11-05T16:45:00",
  },
  {
    slug: "penyaluran-zakat-2025",
    judul: "Penyaluran Zakat Fitrah dan Zakat Mal Tahun 2025",
    thumbnail: "https://images.unsplash.com/photo-1582213782179-e0d53f98f2ca?w=800&h=600&fit=crop",
    url_thumbnail: "https://images.unsplash.com/photo-1582213782179-e0d53f98f2ca?w=800&h=600&fit=crop",
    isi: "Yayasan Sawiyan membuka penyaluran zakat fitrah dan zakat mal untuk disalurkan kepada mustahik yang berhak. Mari tunaikan kewajiban zakat kita melalui yayasan yang terpercaya.",
    date_created: "2024-11-01T11:20:00",
  },
  {
    slug: "pelatihan-keterampilan-2025",
    judul: "Pelatihan Keterampilan untuk Pemberdayaan Masyarakat",
    thumbnail: "https://images.unsplash.com/photo-1524178232363-1fb2b075b655?w=800&h=600&fit=crop",
    url_thumbnail: "https://images.unsplash.com/photo-1524178232363-1fb2b075b655?w=800&h=600&fit=crop",
    isi: "Program pelatihan keterampilan bagi masyarakat untuk meningkatkan kemampuan dan peluang ekonomi. Program ini mencakup berbagai bidang seperti kerajinan, pertanian, dan wirausaha.",
    date_created: "2024-10-28T13:00:00",
  },
];
---

<section class="bg-gradient-to-br from-[#F5F5F5] via-white to-[#F5F5F5] py-16 lg:py-24 relative">
  <!-- Background decorative elements -->
  <div class="absolute top-0 right-0 w-96 h-96 bg-[#388E3C]/5 rounded-full blur-3xl -z-10"></div>
  <div class="absolute bottom-0 left-0 w-96 h-96 bg-[#81D4FA]/5 rounded-full blur-3xl -z-10"></div>

  <div class="container mx-auto px-6 md:px-8 max-w-7xl relative z-10">
    <div class="flex flex-col gap-12">
      {/* Header Section */}
      <div class="flex gap-7 flex-col lg:flex-row lg:items-center lg:justify-between">
        <div class="lg:w-7/12 space-y-4 mb-10">
          {/* Badge */}
          <div class="inline-flex items-center gap-2 px-4 py-2 bg-[#388E3C]/10 rounded-full border border-[#388E3C]/20">
            <span class="text-sm font-medium text-[#388E3C] uppercase tracking-wider">Berita Terkini</span>
          </div>

          <h2 class="text-3xl md:text-4xl lg:text-5xl font-bold bg-gradient-to-r from-[#388E3C] via-[#81D4FA] to-[#FFD700] bg-clip-text text-transparent tracking-tight leading-tight pb-2">
            {title}
          </h2>
        </div>

        {/* Link Section dengan styling tema */}
        <div class="flex justify-end items-center">
          <a
            href={linkHref}
            class="group relative inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-[#388E3C] to-[#81D4FA] text-white font-semibold rounded-full shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 overflow-hidden"
          >
            {/* Shine effect */}
            <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"></div>
            <span class="relative z-10">Lihat Berita Lain</span>
            <ArrowUpRight class="w-5 h-5 relative z-10 transition-transform duration-300 group-hover:translate-x-1 group-hover:-translate-y-1" />
          </a>
        </div>
      </div>

      {/* Carousel Section */}
      <div class="embla-carousel-pengumuman relative py-8 pb-16">
        <div class="embla__viewport overflow-hidden px-2 py-4">
          <div class="embla__container flex gap-6">
            {
              pengumumanData.map((pengumuman: { slug: string; judul: string; thumbnail: string; url_thumbnail: string; isi: string; date_created: string }) => (
                <div class="embla__slide min-w-0 flex-shrink-0 basis-full md:basis-[calc(50%-12px)] lg:basis-[calc(33.333%-16px)]">
                  {/* Card Container dengan depth dan shadow sesuai tema */}
                  <div class="group flex h-full flex-col overflow-hidden rounded-2xl border border-gray-200/50 bg-white shadow-lg hover:shadow-2xl transition-all duration-300 relative">
                    {/* Decorative gradient accent */}
                    <div class="absolute top-0 left-0 right-0 h-1.5 bg-gradient-to-r from-[#388E3C] via-[#81D4FA] to-[#FFD180] opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20" />

                    {/* Decorative corner element */}
                    <div class="absolute top-0 right-0 w-24 h-24 bg-gradient-to-br from-[#81D4FA]/10 to-transparent rounded-bl-full opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-10" />

                    {/* Block 1: Gambar dengan overlay */}
                    <a href={`/berita/${pengumuman.slug}`} class="block shrink-0 relative overflow-hidden">
                      <img src={pengumuman.url_thumbnail} alt={`Thumbnail untuk ${pengumuman.judul}`} class="h-56 w-full object-cover transition-transform duration-500 group-hover:scale-110" />
                      {/* Gradient overlay on hover */}
                      <div class="absolute inset-0 bg-gradient-to-t from-[#388E3C]/0 to-[#388E3C]/0 group-hover:from-[#388E3C]/20 group-hover:to-transparent transition-all duration-300" />
                    </a>

                    {/* Block 2: Konten Teks */}
                    <div class="flex flex-grow flex-col p-6 relative">
                      {/* Background decorative element */}
                      <div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-[#81D4FA]/5 to-transparent rounded-bl-full opacity-0 group-hover:opacity-100 transition-opacity duration-300" />

                      <span class="text-sm text-gray-500 font-medium relative z-10">
                        {new Intl.DateTimeFormat("id-ID", {
                          day: "numeric",
                          month: "long",
                          year: "numeric",
                          hour: "2-digit",
                          minute: "2-digit",
                          timeZoneName: "short",
                        }).format(new Date(pengumuman.date_created))}
                      </span>
                      <h5 class="my-2 text-xl font-bold leading-tight text-gray-900 relative z-10">
                        <a href={`/berita/${pengumuman.slug}`} class="hover:text-[#388E3C] transition-colors duration-200">
                          {pengumuman.judul}
                        </a>
                      </h5>
                      <p class="text-base leading-relaxed text-gray-600 relative z-10 mb-4">{pengumuman.isi?.replace(/<[^>]*>?/gm, " ").substring(0, 100) + "..."}</p>

                      {/* Block 3: Tombol "Read More" dengan enhanced styling */}
                      <div class="mt-auto relative z-10">
                        <a href={`/berita/${pengumuman.slug}`} class="group/btn inline-flex items-center gap-2 font-semibold text-[#388E3C] hover:text-[#81D4FA] transition-colors duration-200">
                          <span class="relative">
                            Baca Selengkapnya
                            <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-gradient-to-r from-[#388E3C] to-[#81D4FA] group-hover/btn:w-full transition-all duration-300" />
                          </span>
                          <ArrowRight class="h-4 w-4 transition-transform duration-200 group-hover/btn:translate-x-1" />
                        </a>
                      </div>
                    </div>
                  </div>
                </div>
              ))
            }
          </div>
        </div>

        {/* Navigation Buttons */}
        <button
          class="embla__prev absolute left-0 top-1/2 -translate-y-1/2 -translate-x-12 hidden lg:flex items-center justify-center w-12 h-12 bg-gradient-to-r from-[#388E3C] to-[#81D4FA] backdrop-blur-sm rounded-full shadow-lg text-white hover:shadow-xl hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#388E3C] disabled:opacity-30 disabled:cursor-not-allowed transition-all duration-300 z-20"
        >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
        </button>
        <button
          class="embla__next absolute right-0 top-1/2 -translate-y-1/2 translate-x-12 hidden lg:flex items-center justify-center w-12 h-12 bg-gradient-to-r from-[#388E3C] to-[#81D4FA] backdrop-blur-sm rounded-full shadow-lg text-white hover:shadow-xl hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#388E3C] disabled:opacity-30 disabled:cursor-not-allowed transition-all duration-300 z-20"
        >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
        </button>
      </div>
    </div>
  </div>
</section>

<script>
  import EmblaCarousel from "embla-carousel";

  const emblaRoot = document.querySelector(".embla-carousel-pengumuman");

  if (emblaRoot) {
    const viewport = emblaRoot.querySelector<HTMLElement>(".embla__viewport");
    const prevBtn = emblaRoot.querySelector<HTMLButtonElement>(".embla__prev");
    const nextBtn = emblaRoot.querySelector<HTMLButtonElement>(".embla__next");

    if (viewport && prevBtn && nextBtn) {
      const emblaApi = EmblaCarousel(viewport, { loop: true, align: "start" });

      const updateArrowButtons = () => {
        if (!emblaApi) return;
        prevBtn.disabled = !emblaApi.canScrollPrev();
        nextBtn.disabled = !emblaApi.canScrollNext();
      };

      // REVISI: Gunakan arrow function untuk menjaga konteks 'this'
      prevBtn.addEventListener("click", () => emblaApi.scrollPrev(), false);
      nextBtn.addEventListener("click", () => emblaApi.scrollNext(), false);

      emblaApi.on("select", updateArrowButtons);
      emblaApi.on("reInit", updateArrowButtons);

      updateArrowButtons();
    }
  }
</script>
